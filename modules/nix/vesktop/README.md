This is taken from the official nixpkgs repos but has some fixes I wanted to make to customize it to my needs.